(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{553:function(e,l,t){Promise.resolve().then(t.bind(t,3816))},3816:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return b}});var a=t(9268),s=t(6006);let r=e=>{let{index:l,move:t,onChange:s,onTabPress:r}=e,n=(e,t)=>{s(l,e.target.value,t)},o=e=>{"Tab"===e.key&&r(l)};return(0,a.jsxs)("div",{className:"flex w-full",children:[(0,a.jsxs)("div",{className:"min-w-[26px] pr-1",children:[l+1,"."]}),(0,a.jsx)("input",{type:"text",className:"border rounded-md p-1 flex-grow w-full ".concat(!1===t.wStatus&&t.w?"border-red-500":"border-gray-300"),value:t.w,onChange:e=>n(e,"w")}),(0,a.jsx)("input",{type:"text",className:"border rounded-md p-1 flex-grow w-full ".concat(!1===t.bStatus&&t.b?"border-red-500":"border-gray-300"),value:t.b,onChange:e=>n(e,"b"),onKeyUp:e=>o(e)})]})};var n=t(8057),o=t(4214),c=e=>{let{value:l,show:t,onAction:s,fileName:r}=e;if(!t)return null;let n=e=>{s&&s(e)};return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-2xl",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"PGN Download"}),(0,a.jsx)("textarea",{className:"border border-gray-300 rounded-md p-2 w-full h-80 resize-y",value:l,onChange:e=>console.log(e.target.value)}),(0,a.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-500 text-white rounded-md",onClick:()=>n("cancel"),children:"Cancel"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md ml-2",onClick:()=>{let e=new Blob([l],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=r||"text-file.pgn",a.click(),URL.revokeObjectURL(t)},children:"Download"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md ml-2",onClick:()=>{o.Z.post("https://github-committer-api.fly.dev/commit",{repoOwner:"samuraitruong",repoName:"chess-tournament-games",filePath:"tournaments/"+r,commitMessage:"Pgn file commit from pgn-editor",content:l})},children:"Sync"})]})]})})};let i=e=>e.replace("0-0","O-O").replace("0-0-0","O-O-O"),d=e=>{let{onMoveChange:l}=e,t=(0,s.useRef)(null),[o,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),[b,x]=(0,s.useState)("chess.pgn"),[h,p]=(0,s.useState)([{label:"Event",value:"",lock:!0},{label:"Site",value:"",lock:!0},{label:"Date",value:"",lock:!0},{label:"Board",value:"",lock:!0},{label:"Round",value:"",lock:!0},{label:"White",value:"",lock:!0},{label:"Black",value:"",lock:!0},{label:"Result",value:"",lock:!0},{label:"TimeControl",value:"",lock:!0}]),[f,v]=(0,s.useState)(Array(20).fill({w:"",b:"",wf:"",bf:""})),[g,w]=(0,s.useState)(!0),j=(e,l)=>{let t=[...h];t[e].value=l.target.value,p(t)},y=(e,l)=>{let t=[...h];t[e].label=l.target.value,p(t)},N=(e,t,a)=>{let s=a+"Status",r=a+"f",o=[];for(let e of f){if(!e.w||!1===e.wStatus&&e.w||(e.wStatus&&o.push(e.w),!e.b||!1===e.bStatus&&e.b))break;e.bStatus&&o.push(e.b)}let c=function(e,l){let t=new n.qQ;for(let l of e)t.move(l);try{let e=t.move(l);return console.log(e),e}catch(e){return{}}}(o,t);console.log(c),v(n=>{let i=[...n];return i[e]={...i[e],[a]:t,[r]:c.after||"",[s]:!!c.after},l&&c.after&&l([...o,t]),i})},k=e=>{e===f.length&&v([...f,{w:"",b:""}])};return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Game Information"}),(0,a.jsxs)("div",{className:"space-y-2",children:[h.map((e,l)=>(0,a.jsxs)("div",{className:"flex full-w",children:[(0,a.jsx)("input",{type:"text",className:"border border-gray-300 rounded-md p-1 w-40 ".concat(e.lock?"disabled":""),disabled:e.lock,value:e.label,onChange:e=>y(l,e)}),(0,a.jsx)("input",{type:"text",className:"border border-gray-300 rounded-md p-1 flex-1",value:e.value,onChange:e=>j(l,e)})]},l)),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{className:"flex items-center space-x-1 text-sm text-white bg-blue-500 rounded-md px-2 py-1",onClick:()=>{p([...h,{label:"",value:"",lock:!1}])},children:(0,a.jsx)("span",{children:"+ More attribute"})})})]}),(0,a.jsx)("hr",{className:"border-t border-gray-400 my-4"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("button",{onClick:()=>{w(!g)},className:"mb-2",children:g?"Switch to Raw Mode":"Switch to Grid Mode"}),g?(0,a.jsx)("div",{className:"flex flex-col gap-1 h-500px overflow-y-auto",ref:t,children:f.map((e,l)=>(0,a.jsx)(r,{onTabPress:k,index:l,move:e,onChange:N},l))}):(0,a.jsx)("textarea",{className:"border border-gray-300 rounded-md p-2 w-full h-500px resize-none",rows:f.length,value:"",onChange:e=>{let l=e.target.value.split(" ").map((e,l)=>({moveIndex:l+1,fen:e}));v(l)}}),(0,a.jsxs)("div",{className:"flex space-x-4 mt-3",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded",onClick:()=>{let e=[...f];for(let l=0;l<10;l++)e.push({w:"",b:""});v(e)},children:"+ Row"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-red-500 text-white rounded",onClick:()=>{var e,l;d(!0);let t=h.reduce((e,l)=>l.label&&l.value?e+"[".concat(l.label,' "').concat(l.value,'"]\n'):e,""),a=f.filter(e=>e.w).map((e,l)=>"".concat(l+1,". ").concat(e.w," ").concat(e.b||"")).join(" ");m(t+"\n"+a),x("".concat(null===(e=h.find(e=>"White"===e.label))||void 0===e?void 0:e.value," vs ").concat(null===(l=h.find(e=>"Black"===e.label))||void 0===l?void 0:l.value,".pgn"))},children:"Save"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-green-500 text-white rounded",onClick:()=>{v(Array(20).fill({w:"",b:""})),l&&l([])},children:"Clear"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"fileInput",className:"inline-block bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded cursor-pointer",children:"Open PGN"}),(0,a.jsx)("input",{type:"file",id:"fileInput",className:"hidden",onChange:e=>{if(!e.target.files)return;let t=e.target.files[0],a=new FileReader;a.onload=e=>{let t=e.target.result,a=function(e){let l={},t=[],a=e.split("\n"),s=a.filter(e=>e.startsWith("[")),r=a.filter(e=>!e.startsWith("["));s.forEach(e=>{let[t,...a]=e.substring(1,e.length-1).split(" "),s=a.join(" ").replace(/"/g,"");l[t]=s});let n=r.join(" "),o=n.split(/\d+\./),c=o.filter(e=>""!==e.trim()).map(e=>e.trim()).filter(e=>""!==e);return c.forEach(e=>{let[l,a]=e.split(" ");l&&a&&t.push([i(l),i(a)])}),{attributes:l,moves:t}}(t),s=Object.entries(a.attributes).map(e=>{let[l,t]=e;return{label:l,value:t,lock:!1}}),r=a.moves.map(e=>{let[l,t]=e;return{w:l,b:t}});v(r),p(s),l&&l(a.moves.flat()),console.log(t,a)},a.readAsText(t)}})]})]})]}),(0,a.jsx)(c,{show:o,value:u,fileName:b,onAction:()=>d(!1)})]})};var u=t(6702);let m=e=>{let[l,t]=(0,s.useState)(new n.qQ),[r,o]=(0,s.useState)([]),[c,i]=(0,s.useState)("");(0,s.useEffect)(()=>{let l=new n.qQ;e.moves.forEach(e=>{try{l.move(e)}catch(l){console.log("error",e)}}),t(l),i(l.fen()),o(l.history({verbose:!0}))},[e.moves]);let d=e=>{i(e.after)};return(0,a.jsxs)("div",{className:"w-full ",children:[(0,a.jsx)(u.r,{id:"BasicBoard",boardWidth:800,position:c}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("ul",{className:"space-x-2",children:r.map((e,l)=>(0,a.jsxs)("li",{className:"inline-block",children:[l%2==0?"".concat(Math.floor((l+1)/2+1),". "):"",(0,a.jsx)("span",{className:"text-blue-500 hover:underline cursor-pointer",onClick:()=>d(e),children:e.san})]},l))}),(0,a.jsxs)("blockquote",{className:"border-l-4 border-gray-500 italic my-4 pl-4 relative",children:[" ","FEN: ",c,(0,a.jsx)("button",{className:"absolute bottom-0 right-0 bg-blue-500 text-white text-xs px-2 py-1 rounded",onClick:()=>(function(e){let l=document.createElement("textarea");l.value=e,l.style.position="fixed",l.style.opacity="0",document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l)})(c),children:"Copy"})]})]})]})};function b(){let[e,l]=(0,s.useState)([]);return(0,a.jsxs)("main",{className:"flex w-full  min-h-screen flex-row justify-between p-6 p-md-2",children:[(0,a.jsx)("div",{className:"w-8/12  items-center justify-center",children:(0,a.jsx)(m,{moves:e})}),(0,a.jsx)("div",{className:"w-4/12",children:(0,a.jsx)("div",{className:"bg-gray-300 p-4",children:(0,a.jsx)(d,{onMoveChange:e=>{l([...e])}})})})]})}}},function(e){e.O(0,[943,466,253,488,744],function(){return e(e.s=553)}),_N_E=e.O()}]);